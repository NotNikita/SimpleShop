// This is your Prisma schema file,

// Quick shortcut to generate anything: Ctrl + Space

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

// Users, Movies, Reviews, Genres, Favourites, Watch History
model User {
  id            String   @id @default(uuid())
  name          String
  email         String   @unique
  password_hash String
  isVerified    Boolean  @default(false)
  tier          UserTier @default(DEFAULT)

  // Arrays
  watchlist WatchList[]
}

// UsersOnContent
model WatchList {
  user_id          String
  content_id       String
  watched_at       DateTime
  duration_watched DateTime

  user    User    @relation(fields: [user_id], references: [id])
  content Content @relation(fields: [content_id], references: [id])

  @@id([user_id, content_id])
}

// Movie or MovieSeries
model Content {
  id               String   @id @default(uuid())
  title            String
  duration_minutes Int
  description      String
  // will be separated into categories by FE
  cast             Person[]
  release          DateTime

  // TODO: genres - can be a tag and implement tag search
  WatchList WatchList[]
}

// Director, Actor, Writer...
model Person {
  id        String    @id @default(uuid())
  fullname  String
  // in which movies he participated and how
  known_for Content[]
}

enum UserTier {
  DEFAULT // 0% discount
  VIP // 5% discount
  BELOVED // 10%

  @@map("CustomerTier")
}

// TODO: Need to be tier between Person and Content
// (which role human done in film)
enum Position {
  PRODUCER
  DIRECTOR
  WRITER
  ACTOR
}
